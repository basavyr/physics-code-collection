(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     48053,       1320]
NotebookOptionsPosition[     44401,       1242]
NotebookOutlinePosition[     44741,       1257]
CellTagsIndexPosition[     44698,       1254]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Rotation of a rank-2 tensor written as a product of two spherical vectors \
",
 StyleBox["A,B",
  FontWeight->"Bold"]
}], "Chapter",
 CellChangeTimes->{{3.825460732990884*^9, 
  3.825460777057428*^9}},ExpressionUUID->"78757379-f552-46b5-922a-\
72222e37f454"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global*`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Off", "[", 
  RowBox[{"ClebschGordan", "::", "phy"}], "]"}]}], "Input",
 CellChangeTimes->{{3.82546081542035*^9, 3.825460826709931*^9}, {
  3.8256335454117203`*^9, 3.825633563877255*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"9cc7d27f-a8e6-46ff-be2c-67f9e931257b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"{", 
    RowBox[{"Vx", ",", "Vy", ",", "Vz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{"{", 
    RowBox[{"Wx", ",", "Wy", ",", "Wz"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.825460830438382*^9, 3.825460850833622*^9}, {
  3.825461591679056*^9, 3.8254616019688663`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"deacf788-95f1-4730-8182-d08a60084873"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"showVecs", "[", 
    RowBox[{"v_", ",", "v1_"}], "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{"\"\<V -> V'\\n\>\"", ",", "Black", ",", "Bold", ",", "20", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"MatrixForm", "[", "v", "]"}], ",", "Red", ",", "Bold", ",", 
       "20", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\< = \>\"", ",", "Black", ",", "20", ",", "Bold", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(R\), \(Z\)]\)(\[Alpha])\>\"", ",", "20", ",", 
       "Blue", ",", "Bold", ",", "Italic", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"MatrixForm", "[", "v1", "]"}], ",", "Red", ",", "Bold", ",", 
       "20", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotateX", "[", 
    RowBox[{"v_", ",", "\[Alpha]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"\[Alpha]", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], ".", 
    "v"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotateY", "[", 
    RowBox[{"v_", ",", "\[Alpha]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"\[Alpha]", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], "]"}], ".", 
    "v"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotateZ", "[", 
    RowBox[{"v_", ",", "\[Alpha]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"\[Alpha]", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], ".", 
    "v"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8254608617649193`*^9, 3.8254609289312363`*^9}, {
  3.82546149546982*^9, 3.825461496647402*^9}, {3.825461638513117*^9, 
  3.8254618373572187`*^9}, {3.8255492867848253`*^9, 3.825549286869451*^9}, {
  3.825550059735366*^9, 3.825550070071888*^9}, {3.825629922728601*^9, 
  3.825629922863415*^9}, {3.825630878601713*^9, 3.825630884899212*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"e715a690-11af-41ff-a01b-ef26718ec5f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VR", "=", 
   RowBox[{"rotateZ", "[", 
    RowBox[{"V", ",", "\[Alpha]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WR", "=", 
   RowBox[{"rotateZ", "[", 
    RowBox[{"W", ",", "\[Alpha]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.82546115124154*^9, 3.825461159228005*^9}, {
  3.825461309799738*^9, 3.825461313317976*^9}, {3.825461606517866*^9, 
  3.825461610643939*^9}, {3.825463824914098*^9, 3.82546382954589*^9}, {
  3.825549268939191*^9, 3.825549271018777*^9}, {3.825629904525436*^9, 
  3.825629906224451*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"d45496ee-05a9-44ec-b96f-0665f61eefd1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"showVecs", "[", 
  RowBox[{"V", ",", "VR"}], "]"}]], "Input",
 CellChangeTimes->{{3.825461476604919*^9, 3.8254614795814533`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"30bbeb34-00c0-4cb4-87a4-6c647b64312f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"V -> V'\\n\"\>",
    StripOnInput->False,
    LineColor->GrayLevel[0],
    FrontFaceColor->GrayLevel[0],
    BackFaceColor->GrayLevel[0],
    GraphicsColor->GrayLevel[0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->GrayLevel[0]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", 
      TagBox[GridBox[{
         {"Vx"},
         {"Vy"},
         {"Vz"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}],
       Column], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" = \"\>",
    StripOnInput->False,
    LineColor->GrayLevel[0],
    FrontFaceColor->GrayLevel[0],
    BackFaceColor->GrayLevel[0],
    GraphicsColor->GrayLevel[0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->GrayLevel[0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(R\\), \\(Z\\)]\\)(\[Alpha])\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontSlant->Italic,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", 
      TagBox[GridBox[{
         {
          RowBox[{
           RowBox[{"Vx", " ", 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "+", 
           RowBox[{"Vy", " ", 
            RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}]},
         {
          RowBox[{
           RowBox[{"Vy", " ", 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "-", 
           RowBox[{"Vx", " ", 
            RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}]},
         {"Vz"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}],
       Column], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->RGBColor[1, 0, 0]]}],
  SequenceForm[
   Style["V -> V'\n", 
    GrayLevel[0], Bold, 20, FontFamily -> "Times"], 
   Style[
    MatrixForm[{$CellContext`Vx, $CellContext`Vy, $CellContext`Vz}], 
    RGBColor[1, 0, 0], Bold, 20, FontFamily -> "Times"], 
   Style[" = ", 
    GrayLevel[0], 20, Bold, FontFamily -> "Times"], 
   Style["\!\(\*SubscriptBox[\(R\), \(Z\)]\)(\[Alpha])", 20, 
    RGBColor[0, 0, 1], Bold, Italic, FontFamily -> "Times"], 
   Style[
    MatrixForm[{$CellContext`Vx Cos[$CellContext`\[Alpha]] + $CellContext`Vy 
       Sin[$CellContext`\[Alpha]], $CellContext`Vy 
       Cos[$CellContext`\[Alpha]] - $CellContext`Vx 
      Sin[$CellContext`\[Alpha]], $CellContext`Vz}], 
    RGBColor[1, 0, 0], Bold, 20, FontFamily -> "Times"]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.825461479979157*^9, 3.825461504085253*^9}, 
   3.825461631343564*^9, {3.82546174860888*^9, 3.8254617732895613`*^9}, 
   3.8254618058980217`*^9, 3.825461839864891*^9, 3.825462111164892*^9, 
   3.825462189675346*^9, 3.825462285931839*^9, 3.825463461417037*^9, 
   3.825463832196327*^9, 3.825465251252892*^9, 3.8255491567088614`*^9, 
   3.825549197159479*^9, 3.8255492955346327`*^9, {3.825549981653844*^9, 
   3.8255499917914143`*^9}, 3.825550073836985*^9, 3.8255991332826433`*^9, 
   3.8256003298774767`*^9, 3.825629684488975*^9, 3.825629925944936*^9, {
   3.825630204617836*^9, 3.825630218826915*^9}, 3.825630306729645*^9, 
   3.825630353666007*^9, {3.82563089131151*^9, 3.8256309353213778`*^9}, 
   3.82563097491473*^9, 3.8256323076247673`*^9, {3.825633077871052*^9, 
   3.825633116086027*^9}, 3.825633566327549*^9, {3.825633908628467*^9, 
   3.8256339186859283`*^9}},
 CellLabel->
  "During evaluation of \
In[11]:=",ExpressionUUID->"af984dec-1528-4ca1-85c3-832264ecb2f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"showVecs", "[", 
  RowBox[{"W", ",", "WR"}], "]"}]], "Input",
 CellChangeTimes->{{3.825461618327629*^9, 3.82546162030823*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"ac5aae97-0615-447f-88a9-36096bf8113e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"V -> V'\\n\"\>",
    StripOnInput->False,
    LineColor->GrayLevel[0],
    FrontFaceColor->GrayLevel[0],
    BackFaceColor->GrayLevel[0],
    GraphicsColor->GrayLevel[0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->GrayLevel[0]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", 
      TagBox[GridBox[{
         {"Wx"},
         {"Wy"},
         {"Wz"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}],
       Column], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" = \"\>",
    StripOnInput->False,
    LineColor->GrayLevel[0],
    FrontFaceColor->GrayLevel[0],
    BackFaceColor->GrayLevel[0],
    GraphicsColor->GrayLevel[0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->GrayLevel[0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(R\\), \\(Z\\)]\\)(\[Alpha])\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontSlant->Italic,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", 
      TagBox[GridBox[{
         {
          RowBox[{
           RowBox[{"Wx", " ", 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "+", 
           RowBox[{"Wy", " ", 
            RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}]},
         {
          RowBox[{
           RowBox[{"Wy", " ", 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "-", 
           RowBox[{"Wx", " ", 
            RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}]},
         {"Wz"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}],
       Column], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->RGBColor[1, 0, 0]]}],
  SequenceForm[
   Style["V -> V'\n", 
    GrayLevel[0], Bold, 20, FontFamily -> "Times"], 
   Style[
    MatrixForm[{$CellContext`Wx, $CellContext`Wy, $CellContext`Wz}], 
    RGBColor[1, 0, 0], Bold, 20, FontFamily -> "Times"], 
   Style[" = ", 
    GrayLevel[0], 20, Bold, FontFamily -> "Times"], 
   Style["\!\(\*SubscriptBox[\(R\), \(Z\)]\)(\[Alpha])", 20, 
    RGBColor[0, 0, 1], Bold, Italic, FontFamily -> "Times"], 
   Style[
    MatrixForm[{$CellContext`Wx Cos[$CellContext`\[Alpha]] + $CellContext`Wy 
       Sin[$CellContext`\[Alpha]], $CellContext`Wy 
       Cos[$CellContext`\[Alpha]] - $CellContext`Wx 
      Sin[$CellContext`\[Alpha]], $CellContext`Wz}], 
    RGBColor[1, 0, 0], Bold, 20, FontFamily -> "Times"]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.825461631367394*^9, {3.825461748642414*^9, 3.825461773320025*^9}, 
   3.825461805923335*^9, 3.825461839897626*^9, 3.825462111173334*^9, 
   3.825462189701668*^9, 3.825462285959096*^9, 3.825463461456354*^9, 
   3.825463832204213*^9, 3.8254652512609043`*^9, 3.825549156739648*^9, 
   3.825549197196876*^9, 3.82554929557141*^9, {3.825549981680737*^9, 
   3.825549991801043*^9}, 3.825550073868194*^9, 3.82559913329008*^9, 
   3.825600329905888*^9, 3.825629684496855*^9, 3.825629925981224*^9, {
   3.825630204625071*^9, 3.8256302188341846`*^9}, 3.825630306738614*^9, 
   3.825630353674271*^9, {3.825630893000593*^9, 3.825630935328857*^9}, 
   3.8256309749212723`*^9, 3.825632307657984*^9, {3.82563307787894*^9, 
   3.825633116108289*^9}, 3.825633566361557*^9, {3.8256339086599483`*^9, 
   3.825633918694685*^9}},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"c868d365-ecf1-4572-b2c7-758de74a0b27"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create the spherical components of the vectors", "Subsection",
 CellChangeTimes->{{3.82546339884536*^9, 
  3.825463408132071*^9}},ExpressionUUID->"f3374489-ddbe-491b-b639-\
ca0eef93ed73"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"spherical1", "[", "v_", "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"-", "1"}], 
     RowBox[{"Sqrt", "[", "2", "]"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{"I", "*", 
       RowBox[{"v", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sphericalm1", "[", "v_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Sqrt", "[", "2", "]"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "-", 
      RowBox[{"I", "*", 
       RowBox[{"v", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spherical0", "[", "v_", "]"}], ":=", 
   RowBox[{"v", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Vsph", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"spherical1", "[", "v", "]"}], ",", 
     RowBox[{"spherical0", "[", "v", "]"}], ",", 
     RowBox[{"sphericalm1", "[", "v", "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.825463412576527*^9, 3.8254634471579742`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"55fc9785-e1ab-4530-93b5-07bec836c8d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Test the change of basis Cartesian -> Spherical\nAfter the rotation \
operator ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["R", "Z"], "(", "\[Alpha]", ")"}], TraditionalForm]],
  ExpressionUUID->"d49a7900-eb06-471f-a034-9bf8c88b839e"],
 " has been applied on the vectors V and W"
}], "Subsection",
 CellChangeTimes->{{3.825465430403483*^9, 
  3.825465492350645*^9}},ExpressionUUID->"94230187-b365-4e93-b3ed-\
6a151575ee51"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xc", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xcr", "[", 
    RowBox[{"v_", ",", "\[Alpha]_"}], "]"}], ":=", 
   RowBox[{"rotateZ", "[", 
    RowBox[{"v", ",", "\[Alpha]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xs", "[", "v_", "]"}], ":=", 
   RowBox[{"Vsph", "[", "v", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"xsr", "[", 
     RowBox[{"v_", ",", "\[Alpha]_"}], "]"}], ":=", 
    RowBox[{"Vsph", "[", 
     RowBox[{"xcr", "[", 
      RowBox[{"v", ",", "\[Alpha]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<(\!\(\*SubscriptBox[\(x\), \(1\)]\)\!\(\*SubscriptBox[\()\), \
\(1\)]\)= \>\"", ",", 
     RowBox[{"xr", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(x\), \(1\)]\)= \>\"", ",", 
     RowBox[{"x", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", "v_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CurlyPhi]", ",", 
       RowBox[{"N", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"xsr", "[", 
            RowBox[{"v", ",", "\[CurlyPhi]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "I"}], "*", "\[CurlyPhi]"}], "]"}], "*", 
           RowBox[{
            RowBox[{"xs", "[", "v", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "]"}], ",", 
       RowBox[{"N", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"xsr", "[", 
            RowBox[{"v", ",", "\[CurlyPhi]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "I"}], "*", "\[CurlyPhi]"}], "]"}], "*", 
           RowBox[{
            RowBox[{"xs", "[", "v", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "]"}], ",", 
       RowBox[{"N", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"xsr", "[", 
            RowBox[{"v", ",", "\[CurlyPhi]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "I"}], "*", "\[CurlyPhi]"}], "]"}], "*", 
           RowBox[{
            RowBox[{"xs", "[", "v", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[CurlyPhi]", ",", 
       RowBox[{"0", "Degree"}], ",", 
       RowBox[{"180", "Degree"}], ",", 
       RowBox[{"10", "Degree"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"test", "[", "xc", "]"}], ",", 
   RowBox[{"Frame", "\[Rule]", "All"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
   RowBox[{"ItemSize", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"ItemStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "Red", "}"}], "}"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"14", ",", "Bold", ",", 
      RowBox[{"FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
     "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzE0og3EAx/E1y5aJKSueMnZw8LKDg62Y4jAHRFveii0e5mXJoh28lJdy
UdsahTSJ2VizMi8lDpvEDiLKW5lspUht47lJ3p7f//Drc/jVV0obNXouh8OR
sIM0vyR1bCJakUPXEQVv8QI4KxtVwG5hhhJyzcEyeFxOq+COeKUWJnuFLVCh
TmmDBrndQXrOrTV43Sr2wahAQvxtTDyAbkvPIaT9jlOo27w9g5QjcAedDdf3
UKs2hGGTaygCI3zrCzy31MRgT0I5A59M79+w2ZKTNc76GhRIocX4Fdtg5dUX
MtCjc3HcrCK/h7h9zIigdj0zDe6fBvJgejYvH3adJyvgQuOMEj52tKngoHFE
A98nk1SXrBdbMmJVZaQdmvM9ethH+XphcHWqHwrDucPktz1PQOpTOQ0r9yQ2
uGgLzUHt7g9x6e/mBMqXP4gPpvkQlLk641Ci8VJXrNajahk8sDNF0F46UAz/
AVsZ/nA=
  "],
 CellLabel->"In[17]:=",ExpressionUUID->"502d581b-cf12-48d5-9693-19cc88bd081b"],

Cell[BoxData[
 TagBox[GridBox[{
    {"0", "0.`", "0.`", "0.`"},
    {
     RowBox[{"10", " ", "\[Degree]"}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"20", " ", "\[Degree]"}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"30", " ", "\[Degree]"}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"40", " ", "\[Degree]"}], 
     RowBox[{
      RowBox[{"-", "2.220446049250313`*^-16"}], "-", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{
      RowBox[{"-", "2.220446049250313`*^-16"}], "-", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{
      RowBox[{"-", "2.220446049250313`*^-16"}], "-", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"50", " ", "\[Degree]"}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"60", " ", "\[Degree]"}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.6653345369377348`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.6653345369377348`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.6653345369377348`*^-16", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"70", " ", "\[Degree]"}], 
     RowBox[{
      RowBox[{"-", "4.440892098500626`*^-16"}], "+", 
      RowBox[{"3.3306690738754696`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{
      RowBox[{"-", "4.440892098500626`*^-16"}], "+", 
      RowBox[{"3.3306690738754696`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{
      RowBox[{"-", "4.440892098500626`*^-16"}], "+", 
      RowBox[{"3.3306690738754696`*^-16", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"80", " ", "\[Degree]"}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.1102230246251565`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.1102230246251565`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.1102230246251565`*^-16", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"90", " ", "\[Degree]"}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.1102230246251565`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.1102230246251565`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.1102230246251565`*^-16", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"100", " ", "\[Degree]"}], 
     RowBox[{"2.220446049250313`*^-16", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"2.220446049250313`*^-16", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"2.220446049250313`*^-16", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"110", " ", "\[Degree]"}], 
     RowBox[{"2.220446049250313`*^-16", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"2.220446049250313`*^-16", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"2.220446049250313`*^-16", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"120", " ", "\[Degree]"}], 
     RowBox[{"6.661338147750939`*^-16", "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"6.661338147750939`*^-16", "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"6.661338147750939`*^-16", "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"130", " ", "\[Degree]"}], 
     RowBox[{
      RowBox[{"-", "2.220446049250313`*^-16"}], "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{
      RowBox[{"-", "2.220446049250313`*^-16"}], "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{
      RowBox[{"-", "2.220446049250313`*^-16"}], "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"140", " ", "\[Degree]"}], 
     RowBox[{"5.551115123125783`*^-16", "+", 
      RowBox[{"4.440892098500626`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"5.551115123125783`*^-16", "+", 
      RowBox[{"4.440892098500626`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"5.551115123125783`*^-16", "+", 
      RowBox[{"4.440892098500626`*^-16", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"150", " ", "\[Degree]"}], 
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-16"}], "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-16"}], "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-16"}], "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"160", " ", "\[Degree]"}], 
     RowBox[{"4.440892098500626`*^-16", "+", 
      RowBox[{"4.440892098500626`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"4.440892098500626`*^-16", "+", 
      RowBox[{"4.440892098500626`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"4.440892098500626`*^-16", "+", 
      RowBox[{"4.440892098500626`*^-16", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"170", " ", "\[Degree]"}], 
     RowBox[{
      RowBox[{"-", "3.3306690738754696`*^-16"}], "-", 
      RowBox[{"4.440892098500626`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{
      RowBox[{"-", "3.3306690738754696`*^-16"}], "-", 
      RowBox[{"4.440892098500626`*^-16", " ", "\[ImaginaryI]"}]}], 
     RowBox[{
      RowBox[{"-", "3.3306690738754696`*^-16"}], "-", 
      RowBox[{"4.440892098500626`*^-16", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"180", " ", "\[Degree]"}], 
     RowBox[{"2.220446049250313`*^-16", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"2.220446049250313`*^-16", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"2.220446049250313`*^-16", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
   },
   AutoDelete->False,
   BaseStyle->{14, Bold, FontFamily -> "Times New Roman"},
   FrameStyle->Directive[
     GrayLevel[0], 
     Thickness[Large]],
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
   GridBoxItemStyle->{"Columns" -> {
       RGBColor[1, 0, 0]}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.825631653409594*^9, 3.825631659720809*^9}, 
   3.825632307699443*^9, {3.825633077955894*^9, 3.825633116154315*^9}, 
   3.825633566406878*^9, {3.825633908704664*^9, 3.825633918809228*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"bdde5120-5953-45b4-8b57-50e396962a2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plotVectors", "[", 
    RowBox[{"v1_", ",", "v2_", ",", "range_"}], "]"}], ":=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "v1"}], "}"}], 
          "]"}], ",", "Thick", ",", "Red"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "v2"}], "}"}], 
          "]"}], ",", "Thick", ",", "Blue"}], "]"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "range"}], ",", "range"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "range"}], ",", "range"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "range"}], ",", "range"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plotVectors", "[", 
  RowBox[{"xc", ",", 
   RowBox[{"xcr", "[", 
    RowBox[{"xc", ",", "30"}], "]"}], ",", "4"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8255493397935953`*^9, 3.825549418709736*^9}, {
  3.825549480315505*^9, 3.825549633436602*^9}, {3.82555004060995*^9, 
  3.82555004522021*^9}, {3.825550082617629*^9, 3.8255501180294228`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"7c1d7092-1a14-44b4-a243-ddee5b03325f"],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[1, 0, 0], Thickness[Large], 
    Arrow3DBox[{{0, 0, 0}, {1, 3, 4}}]}, 
   {RGBColor[0, 0, 1], Thickness[Large], 
    Arrow3DBox[
     NCache[{{0, 0, 0}, {Cos[30] + 3 Sin[30], 3 Cos[30] - Sin[30], 4}}, {{0, 
       0, 0}, {-2.8098434223910016`, 1.450785973755614, 4}}]]}},
  Boxed->False,
  ImageSize->{388.29077074708107`, 415.6676586662197},
  ImageSizeRaw->Automatic,
  PlotRange->{{-4, 4}, {-4, 4}, {-4, 4}},
  ViewPoint->{0.2728046440601581, -1.9789151042670665`, 2.731203514255734},
  ViewVertical->{-0.4217866028801345, 0.16235219548652124`, 
   0.8920413814681145}]], "Output",
 CellChangeTimes->{
  3.82555008603966*^9, 3.825550119679202*^9, 3.825599133741148*^9, 
   3.82560032994602*^9, 3.8256296849900503`*^9, 3.825629926074073*^9, {
   3.825630204728257*^9, 3.825630218924151*^9}, 3.825630306872867*^9, 
   3.825630353792794*^9, {3.8256309083421507`*^9, 3.825630935432212*^9}, 
   3.8256309750774603`*^9, 3.825632307733316*^9, {3.825633077993924*^9, 
   3.825633116175939*^9}, 3.825633566445833*^9, {3.825633908739149*^9, 
   3.825633918846684*^9}},
 CellLabel->"Out[24]=",ExpressionUUID->"edafc4fa-b6cb-4bdd-84f4-2af2af654148"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Create the 3x3 matrix that changes the components of the spherical tensor \
under the rotation\
\>", "Section",
 CellChangeTimes->{{3.825549233555708*^9, 
  3.825549253503599*^9}},ExpressionUUID->"f67ef5cf-ab3b-494c-b8b2-\
bed72bd5a07e"],

Cell[CellGroupData[{

Cell["Operations on a rank-2 tensor", "Subsection",
 CellChangeTimes->{{3.825461570887026*^9, 
  3.8254615758372803`*^9}},ExpressionUUID->"1f5ca1d6-de0b-4f81-99b8-\
aab49ea74b3f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{"A_", ",", "B_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ClebschGordan", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "m1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "m2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "\[Mu]"}], "}"}]}], "]"}], "*", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"2", "-", "m1"}], "]"}], "]"}], "*", 
         RowBox[{"B", "[", 
          RowBox[{"[", 
           RowBox[{"2", "-", "m2"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"m2", ",", "1", ",", 
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"m1", ",", "1", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T2", "[", 
    RowBox[{"A_", ",", "B_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"A", ",", "B", ",", "\[Mu]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"T", "[", 
         RowBox[{"A", ",", "B", ",", "\[Mu]"}], "]"}], "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorTable", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Mu]", ",", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"T2", "[", 
         RowBox[{
          RowBox[{"Vsph", "[", "VR", "]"}], ",", 
          RowBox[{"Vsph", "[", "WR", "]"}], ",", "\[Mu]"}], "]"}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Mu]", ",", "2", ",", 
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{"TensorTable", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\[Mu]\>\"", ",", 
       "\"\<(\!\(\*SubsuperscriptBox[\(T\), \(2\), \
\(\[Mu]\)]\)\!\(\*SubscriptBox[\()\), \(1\)]\)\>\""}], "}"}]}], "]"}], ",", 
   RowBox[{"Frame", "\[Rule]", "All"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
   RowBox[{"ItemSize", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"ItemStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "Red", "}"}], "}"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"22", ",", "Bold", ",", 
      RowBox[{"FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
     "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.82546157942871*^9, 3.825461585219157*^9}, {
  3.825461624818181*^9, 3.825461628837122*^9}, {3.825461851498149*^9, 
  3.825462070602565*^9}, {3.825462121959271*^9, 3.8254621823841543`*^9}, {
  3.825632530221938*^9, 3.82563271675598*^9}, {3.825632835191218*^9, 
  3.825632867841612*^9}, {3.825632970713517*^9, 3.82563297579335*^9}, {
  3.825633014991015*^9, 3.825633095460071*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"3aca94a1-f9ec-4d22-88d7-bbfb18af2b30"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\[Mu]\"\>", "\<\"(\\!\\(\\*SubsuperscriptBox[\\(T\\), \\(2\\), \\(\
\[Mu]\\)]\\)\\!\\(\\*SubscriptBox[\\()\\), \\(1\\)]\\)\"\>"},
    {"2", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
      RowBox[{"(", 
       RowBox[{"Vx", "+", 
        RowBox[{"\[ImaginaryI]", " ", "Vy"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"Wx", "+", 
        RowBox[{"\[ImaginaryI]", " ", "Wy"}]}], ")"}]}]},
    {"1", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Alpha]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Vz", " ", 
         RowBox[{"(", 
          RowBox[{"Wx", "+", 
           RowBox[{"\[ImaginaryI]", " ", "Wy"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Vx", "+", 
           RowBox[{"\[ImaginaryI]", " ", "Vy"}]}], ")"}], " ", "Wz"}]}], 
       ")"}]}]},
    {"0", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"Vx", " ", "Wx"}], "+", 
        RowBox[{"Vy", " ", "Wy"}], "-", 
        RowBox[{"2", " ", "Vz", " ", "Wz"}]}], 
       SqrtBox["6"]]}]},
    {
     RowBox[{"-", "1"}], 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Vz", " ", 
         RowBox[{"(", 
          RowBox[{"Wx", "-", 
           RowBox[{"\[ImaginaryI]", " ", "Wy"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Vx", "-", 
           RowBox[{"\[ImaginaryI]", " ", "Vy"}]}], ")"}], " ", "Wz"}]}], 
       ")"}]}]},
    {
     RowBox[{"-", "2"}], 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
      RowBox[{"(", 
       RowBox[{"Vx", "-", 
        RowBox[{"\[ImaginaryI]", " ", "Vy"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"Wx", "-", 
        RowBox[{"\[ImaginaryI]", " ", "Wy"}]}], ")"}]}]}
   },
   AutoDelete->False,
   BaseStyle->{22, Bold, FontFamily -> "Times New Roman"},
   FrameStyle->Directive[
     GrayLevel[0], 
     Thickness[Large]],
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
   GridBoxItemStyle->{"Columns" -> {
       RGBColor[1, 0, 0]}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.825632836127454*^9, 3.825632868291788*^9}, 
   3.825632980173335*^9, 3.825633015652502*^9, {3.8256330640368643`*^9, 
   3.825633116244035*^9}, 3.8256335665031023`*^9, {3.825633908827335*^9, 
   3.825633919099553*^9}},
 CellLabel->"Out[28]=",ExpressionUUID->"23a7e8be-7a32-4806-97a3-240b7b0656e8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate the rotated Cartesian vectors", "Section",
 CellChangeTimes->{{3.825600086460772*^9, 3.825600095753449*^9}, 
   3.825600154719203*^9},ExpressionUUID->"469a5b6f-e325-4617-a954-\
c9837319194d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VAC", "=", 
   RowBox[{"{", 
    RowBox[{"AX", ",", "AY", ",", "AZ"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VBC", "=", 
   RowBox[{"{", 
    RowBox[{"BX", ",", "BY", ",", "BZ"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RVAC", "=", 
   RowBox[{"rotateZ", "[", 
    RowBox[{"VAC", ",", "\[Alpha]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RVBC", "=", 
   RowBox[{"rotateZ", "[", 
    RowBox[{"VBC", ",", "\[Alpha]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8256000976679*^9, 3.825600150203229*^9}, {
  3.82560099194375*^9, 3.825600992109858*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"5e47b7b8-200d-47f2-9c70-e025972845b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate the rotated spherical vectors", "Section",
 CellChangeTimes->{{3.8256001562424*^9, 
  3.825600164881917*^9}},ExpressionUUID->"3a81e2c4-9039-4b9a-84bb-\
4bd6fdca428c"],

Cell[CellGroupData[{

Cell["\<\
Show all the valid Clebsch Gordan coefficients for a given set of quantum \
numbers (k,\[Mu])\
\>", "Subsection",
 CellChangeTimes->{{3.8256342543520393`*^9, 
  3.82563428796793*^9}},ExpressionUUID->"44b992cd-f9d6-4c28-a5c1-\
7914fe2a7698"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"coeffs", "[", 
    RowBox[{"k_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ClebschGordan", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "m1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "m2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "\[Mu]"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"m2", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"m1", ",", "1", ",", 
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"coeffs", "[", 
      RowBox[{"2", ",", "a"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "2", ",", 
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.825634298344041*^9, 3.825634406834483*^9}, {
  3.825634499831504*^9, 3.8256347735729313`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"7bbaf2f7-051c-48b1-aa71-86ac8a47e0af"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "", ""},
    {
     FractionBox["1", 
      SqrtBox["2"]], 
     FractionBox["1", 
      SqrtBox["2"]], ""},
    {
     FractionBox["1", 
      SqrtBox["6"]], 
     SqrtBox[
      FractionBox["2", "3"]], 
     FractionBox["1", 
      SqrtBox["6"]]},
    {
     FractionBox["1", 
      SqrtBox["2"]], 
     FractionBox["1", 
      SqrtBox["2"]], ""},
    {"1", "", ""}
   },
   AutoDelete->False,
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.825634385610785*^9, 3.825634407515732*^9}, {
  3.825634501406065*^9, 3.825634559046616*^9}, {3.825634591423079*^9, 
  3.825634773864452*^9}},
 CellLabel->"Out[95]=",ExpressionUUID->"4e507b81-0d39-4bcc-bf1f-505edab81041"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VAS", "=", 
   RowBox[{"Vsph", "[", "VAC", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VASR", "=", 
   RowBox[{"Vsph", "[", "RVAC", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VBS", "=", 
   RowBox[{"Vsph", "[", "VBC", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VBSR", "=", 
   RowBox[{"Vsph", "[", "RVBC", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8256001680259666`*^9, 3.8256001980611153`*^9}, {
  3.825600255040386*^9, 3.8256003319359627`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"02fe3f2d-241e-41a1-a22a-c4e6884070e0"],

Cell[CellGroupData[{

Cell[BoxData["VAS"], "Input",
 CellChangeTimes->{{3.8256341599027863`*^9, 3.825634160325511*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"77640edd-6eea-4c39-9291-963cad399baf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"AX", "+", 
      RowBox[{"\[ImaginaryI]", " ", "AY"}]}], 
     SqrtBox["2"]]}], ",", "AZ", ",", 
   FractionBox[
    RowBox[{"AX", "-", 
     RowBox[{"\[ImaginaryI]", " ", "AY"}]}], 
    SqrtBox["2"]]}], "}"}]], "Output",
 CellChangeTimes->{3.825634160729649*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"85624476-2dc6-4fab-b900-ec6b5d170655"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1004, 1167},
WindowMargins->{{Automatic, 248}, {68, Automatic}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 276, 8, 117, "Chapter",ExpressionUUID->"78757379-f552-46b5-922a-72222e37f454"],
Cell[701, 25, 388, 8, 52, "Input",ExpressionUUID->"9cc7d27f-a8e6-46ff-be2c-67f9e931257b"],
Cell[1092, 35, 459, 12, 52, "Input",ExpressionUUID->"deacf788-95f1-4730-8182-d08a60084873"],
Cell[1554, 49, 2693, 67, 157, "Input",ExpressionUUID->"e715a690-11af-41ff-a01b-ef26718ec5f6"],
Cell[4250, 118, 657, 14, 52, "Input",ExpressionUUID->"d45496ee-05a9-44ec-b96f-0665f61eefd1"],
Cell[CellGroupData[{
Cell[4932, 136, 232, 4, 30, "Input",ExpressionUUID->"30bbeb34-00c0-4cb4-87a4-6c647b64312f"],
Cell[5167, 142, 4911, 132, 113, "Print",ExpressionUUID->"af984dec-1528-4ca1-85c3-832264ecb2f6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10115, 279, 229, 4, 30, "Input",ExpressionUUID->"ac5aae97-0615-447f-88a9-36096bf8113e"],
Cell[10347, 285, 4852, 132, 113, "Print",ExpressionUUID->"c868d365-ecf1-4572-b2c7-758de74a0b27"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15236, 422, 193, 3, 54, "Subsection",ExpressionUUID->"f3374489-ddbe-491b-b639-ca0eef93ed73"],
Cell[15432, 427, 1388, 44, 136, "Input",ExpressionUUID->"55fc9785-e1ab-4530-93b5-07bec836c8d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16857, 476, 455, 12, 81, "Subsection",ExpressionUUID->"94230187-b365-4e93-b3ed-6a151575ee51"],
Cell[CellGroupData[{
Cell[17337, 492, 4246, 118, 199, "Input",ExpressionUUID->"502d581b-cf12-48d5-9693-19cc88bd081b"],
Cell[21586, 612, 7774, 176, 492, "Output",ExpressionUUID->"bdde5120-5953-45b4-8b57-50e396962a2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29397, 793, 1701, 46, 94, "Input",ExpressionUUID->"7c1d7092-1a14-44b4-a243-ddee5b03325f"],
Cell[31101, 841, 1184, 23, 433, "Output",ExpressionUUID->"edafc4fa-b6cb-4bdd-84f4-2af2af654148"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32334, 870, 247, 6, 105, "Section",ExpressionUUID->"f67ef5cf-ab3b-494c-b8b2-bed72bd5a07e"],
Cell[CellGroupData[{
Cell[32606, 880, 179, 3, 54, "Subsection",ExpressionUUID->"1f5ca1d6-de0b-4f81-99b8-aab49ea74b3f"],
Cell[CellGroupData[{
Cell[32810, 887, 3426, 94, 161, "Input",ExpressionUUID->"3aca94a1-f9ec-4d22-88d7-bbfb18af2b30"],
Cell[36239, 983, 2974, 86, 278, "Output",ExpressionUUID->"23a7e8be-7a32-4806-97a3-240b7b0656e8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39274, 1076, 206, 3, 67, "Section",ExpressionUUID->"469a5b6f-e325-4617-a954-c9837319194d"],
Cell[39483, 1081, 742, 21, 94, "Input",ExpressionUUID->"5e47b7b8-200d-47f2-9c70-e025972845b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40262, 1107, 181, 3, 67, "Section",ExpressionUUID->"3a81e2c4-9039-4b9a-84bb-4bd6fdca428c"],
Cell[CellGroupData[{
Cell[40468, 1114, 250, 6, 54, "Subsection",ExpressionUUID->"44b992cd-f9d6-4c28-a5c1-7914fe2a7698"],
Cell[CellGroupData[{
Cell[40743, 1124, 1493, 42, 94, "Input",ExpressionUUID->"7bbaf2f7-051c-48b1-aa71-86ac8a47e0af"],
Cell[42239, 1168, 840, 29, 195, "Output",ExpressionUUID->"4e507b81-0d39-4bcc-bf1f-505edab81041"]
}, Open  ]],
Cell[43094, 1200, 621, 15, 94, "Input",ExpressionUUID->"02fe3f2d-241e-41a1-a22a-c4e6884070e0"],
Cell[CellGroupData[{
Cell[43740, 1219, 176, 2, 30, "Input",ExpressionUUID->"77640edd-6eea-4c39-9291-963cad399baf"],
Cell[43919, 1223, 430, 13, 54, "Output",ExpressionUUID->"85624476-2dc6-4fab-b900-ec6b5d170655"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

