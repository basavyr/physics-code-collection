(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     45505,       1213]
NotebookOptionsPosition[     41061,       1130]
NotebookOutlinePosition[     41401,       1145]
CellTagsIndexPosition[     41358,       1142]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Rotation of a rank-2 tensor written as a product of two spherical vectors \
",
 StyleBox["A,B",
  FontWeight->"Bold"]
}], "Chapter",
 CellChangeTimes->{{3.825460732990884*^9, 
  3.825460777057428*^9}},ExpressionUUID->"78757379-f552-46b5-922a-\
72222e37f454"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global*`\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.82546081542035*^9, 3.825460826709931*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"9cc7d27f-a8e6-46ff-be2c-67f9e931257b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"{", 
    RowBox[{"Vx", ",", "Vy", ",", "Vz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{"{", 
    RowBox[{"Wx", ",", "Wy", ",", "Wz"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.825460830438382*^9, 3.825460850833622*^9}, {
  3.825461591679056*^9, 3.8254616019688663`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"deacf788-95f1-4730-8182-d08a60084873"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"showVecs", "[", 
    RowBox[{"v_", ",", "v1_"}], "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{"\"\<V -> V'\\n\>\"", ",", "Black", ",", "Bold", ",", "20", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"MatrixForm", "[", "v", "]"}], ",", "Red", ",", "Bold", ",", 
       "20", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\< = \>\"", ",", "Black", ",", "20", ",", "Bold", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(R\), \(Y\)]\)(\[Alpha])\>\"", ",", "20", ",", 
       "Blue", ",", "Bold", ",", "Italic", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"MatrixForm", "[", "v1", "]"}], ",", "Red", ",", "Bold", ",", 
       "20", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotateX", "[", 
    RowBox[{"v_", ",", "\[Alpha]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], ".", 
    "v"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotateY", "[", 
    RowBox[{"v_", ",", "\[Alpha]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], "]"}], ".", 
    "v"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotateZ", "[", 
    RowBox[{"v_", ",", "\[Alpha]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], ".", 
    "v"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8254608617649193`*^9, 3.8254609289312363`*^9}, {
  3.82546149546982*^9, 3.825461496647402*^9}, {3.825461638513117*^9, 
  3.8254618373572187`*^9}, {3.8255492867848253`*^9, 3.825549286869451*^9}, {
  3.825550059735366*^9, 3.825550070071888*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"e715a690-11af-41ff-a01b-ef26718ec5f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VR", "=", 
   RowBox[{"rotateY", "[", 
    RowBox[{"V", ",", "\[Alpha]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WR", "=", 
   RowBox[{"rotateY", "[", 
    RowBox[{"W", ",", "\[Alpha]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.82546115124154*^9, 3.825461159228005*^9}, {
  3.825461309799738*^9, 3.825461313317976*^9}, {3.825461606517866*^9, 
  3.825461610643939*^9}, {3.825463824914098*^9, 3.82546382954589*^9}, {
  3.825549268939191*^9, 3.825549271018777*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"d45496ee-05a9-44ec-b96f-0665f61eefd1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"showVecs", "[", 
  RowBox[{"V", ",", "VR"}], "]"}]], "Input",
 CellChangeTimes->{{3.825461476604919*^9, 3.8254614795814533`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"30bbeb34-00c0-4cb4-87a4-6c647b64312f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"V -> V'\\n\"\>",
    StripOnInput->False,
    LineColor->GrayLevel[0],
    FrontFaceColor->GrayLevel[0],
    BackFaceColor->GrayLevel[0],
    GraphicsColor->GrayLevel[0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->GrayLevel[0]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", 
      TagBox[GridBox[{
         {"Vx"},
         {"Vy"},
         {"Vz"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}],
       Column], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" = \"\>",
    StripOnInput->False,
    LineColor->GrayLevel[0],
    FrontFaceColor->GrayLevel[0],
    BackFaceColor->GrayLevel[0],
    GraphicsColor->GrayLevel[0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->GrayLevel[0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(R\\), \\(Y\\)]\\)(\[Alpha])\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontSlant->Italic,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", 
      TagBox[GridBox[{
         {
          RowBox[{
           RowBox[{"Vx", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}], "-", 
           RowBox[{"Vz", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}]}]},
         {"Vy"},
         {
          RowBox[{
           RowBox[{"Vz", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}], "+", 
           RowBox[{"Vx", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}]}]}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}],
       Column], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->RGBColor[1, 0, 0]]}],
  SequenceForm[
   Style["V -> V'\n", 
    GrayLevel[0], Bold, 20, FontFamily -> "Times"], 
   Style[
    MatrixForm[{$CellContext`Vx, $CellContext`Vy, $CellContext`Vz}], 
    RGBColor[1, 0, 0], Bold, 20, FontFamily -> "Times"], 
   Style[" = ", 
    GrayLevel[0], 20, Bold, FontFamily -> "Times"], 
   Style["\!\(\*SubscriptBox[\(R\), \(Y\)]\)(\[Alpha])", 20, 
    RGBColor[0, 0, 1], Bold, Italic, FontFamily -> "Times"], 
   Style[
    MatrixForm[{$CellContext`Vx 
       Cos[Rational[1, 180] Pi $CellContext`\[Alpha]] - $CellContext`Vz 
      Sin[Rational[1, 180] 
        Pi $CellContext`\[Alpha]], $CellContext`Vy, $CellContext`Vz 
       Cos[Rational[1, 180] Pi $CellContext`\[Alpha]] + $CellContext`Vx 
       Sin[Rational[1, 180] Pi $CellContext`\[Alpha]]}], 
    RGBColor[1, 0, 0], Bold, 20, FontFamily -> "Times"]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.825461479979157*^9, 3.825461504085253*^9}, 
   3.825461631343564*^9, {3.82546174860888*^9, 3.8254617732895613`*^9}, 
   3.8254618058980217`*^9, 3.825461839864891*^9, 3.825462111164892*^9, 
   3.825462189675346*^9, 3.825462285931839*^9, 3.825463461417037*^9, 
   3.825463832196327*^9, 3.825465251252892*^9, 3.8255491567088614`*^9, 
   3.825549197159479*^9, 3.8255492955346327`*^9, {3.825549981653844*^9, 
   3.8255499917914143`*^9}, 3.825550073836985*^9, 3.8255991332826433`*^9, 
   3.8256003298774767`*^9},
 CellLabel->
  "During evaluation of \
In[41]:=",ExpressionUUID->"01a2b91a-7dad-4434-ad3b-8ff7c8ebba61"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"showVecs", "[", 
  RowBox[{"W", ",", "WR"}], "]"}]], "Input",
 CellChangeTimes->{{3.825461618327629*^9, 3.82546162030823*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"ac5aae97-0615-447f-88a9-36096bf8113e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"V -> V'\\n\"\>",
    StripOnInput->False,
    LineColor->GrayLevel[0],
    FrontFaceColor->GrayLevel[0],
    BackFaceColor->GrayLevel[0],
    GraphicsColor->GrayLevel[0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->GrayLevel[0]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", 
      TagBox[GridBox[{
         {"Wx"},
         {"Wy"},
         {"Wz"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}],
       Column], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" = \"\>",
    StripOnInput->False,
    LineColor->GrayLevel[0],
    FrontFaceColor->GrayLevel[0],
    BackFaceColor->GrayLevel[0],
    GraphicsColor->GrayLevel[0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->GrayLevel[0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(R\\), \\(Y\\)]\\)(\[Alpha])\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontSlant->Italic,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", 
      TagBox[GridBox[{
         {
          RowBox[{
           RowBox[{"Wx", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}], "-", 
           RowBox[{"Wz", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}]}]},
         {"Wy"},
         {
          RowBox[{
           RowBox[{"Wz", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}], "+", 
           RowBox[{"Wx", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}]}]}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}],
       Column], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Times",
    FontSize->20,
    FontWeight->Bold,
    FontColor->RGBColor[1, 0, 0]]}],
  SequenceForm[
   Style["V -> V'\n", 
    GrayLevel[0], Bold, 20, FontFamily -> "Times"], 
   Style[
    MatrixForm[{$CellContext`Wx, $CellContext`Wy, $CellContext`Wz}], 
    RGBColor[1, 0, 0], Bold, 20, FontFamily -> "Times"], 
   Style[" = ", 
    GrayLevel[0], 20, Bold, FontFamily -> "Times"], 
   Style["\!\(\*SubscriptBox[\(R\), \(Y\)]\)(\[Alpha])", 20, 
    RGBColor[0, 0, 1], Bold, Italic, FontFamily -> "Times"], 
   Style[
    MatrixForm[{$CellContext`Wx 
       Cos[Rational[1, 180] Pi $CellContext`\[Alpha]] - $CellContext`Wz 
      Sin[Rational[1, 180] 
        Pi $CellContext`\[Alpha]], $CellContext`Wy, $CellContext`Wz 
       Cos[Rational[1, 180] Pi $CellContext`\[Alpha]] + $CellContext`Wx 
       Sin[Rational[1, 180] Pi $CellContext`\[Alpha]]}], 
    RGBColor[1, 0, 0], Bold, 20, FontFamily -> "Times"]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.825461631367394*^9, {3.825461748642414*^9, 3.825461773320025*^9}, 
   3.825461805923335*^9, 3.825461839897626*^9, 3.825462111173334*^9, 
   3.825462189701668*^9, 3.825462285959096*^9, 3.825463461456354*^9, 
   3.825463832204213*^9, 3.8254652512609043`*^9, 3.825549156739648*^9, 
   3.825549197196876*^9, 3.82554929557141*^9, {3.825549981680737*^9, 
   3.825549991801043*^9}, 3.825550073868194*^9, 3.82559913329008*^9, 
   3.825600329905888*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"f5621a31-3d05-4131-94f1-3880bab339d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create the spherical components of the vectors", "Subsection",
 CellChangeTimes->{{3.82546339884536*^9, 
  3.825463408132071*^9}},ExpressionUUID->"f3374489-ddbe-491b-b639-\
ca0eef93ed73"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"spherical1", "[", "v_", "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"-", "1"}], 
     RowBox[{"Sqrt", "[", "2", "]"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{"I", "*", 
       RowBox[{"v", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sphericalm1", "[", "v_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Sqrt", "[", "2", "]"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "-", 
      RowBox[{"I", "*", 
       RowBox[{"v", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spherical0", "[", "v_", "]"}], ":=", 
   RowBox[{"v", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Vsph", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"spherical1", "[", "v", "]"}], ",", 
     RowBox[{"spherical0", "[", "v", "]"}], ",", 
     RowBox[{"sphericalm1", "[", "v", "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.825463412576527*^9, 3.8254634471579742`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"55fc9785-e1ab-4530-93b5-07bec836c8d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Test the change of basis Cartesian -> Spherical\nAfter the rotation \
operator ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["R", "Z"], "(", "\[Alpha]", ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "d49a7900-eb06-471f-a034-9bf8c88b839e"],
 " has been applied on the vectors V and W"
}], "Subsection",
 CellChangeTimes->{{3.825465430403483*^9, 
  3.825465492350645*^9}},ExpressionUUID->"94230187-b365-4e93-b3ed-\
6a151575ee51"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xc", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xcr", "[", 
    RowBox[{"v_", ",", "\[Alpha]_"}], "]"}], ":=", 
   RowBox[{"rotateY", "[", 
    RowBox[{"v", ",", "\[Alpha]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xs", "[", "v_", "]"}], ":=", 
   RowBox[{"Vsph", "[", "v", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"xsr", "[", "v_", "]"}], ":=", 
    RowBox[{"Vsph", "[", "v", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<(\!\(\*SubscriptBox[\(x\), \(1\)]\)\!\(\*SubscriptBox[\()\), \
\(1\)]\)= \>\"", ",", 
     RowBox[{"xr", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(x\), \(1\)]\)= \>\"", ",", 
     RowBox[{"x", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "[", 
    RowBox[{"v_", ",", "vr_", ",", "\[CurlyPhi]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"xsr", "[", "vr", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "\[CurlyPhi]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"xs", "[", "v", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"N", "[", 
       RowBox[{"test", "[", 
        RowBox[{"t", "*", 
         RowBox[{"\[Pi]", "/", "180"}]}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "120", ",", "10"}], "}"}]}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQncRuxV/X8MZRIckfTHO8fKcNoifpVpuD6HRuCRsQ
zdRzzBZEH3JIcgXRm0QX+IFonjXc0SDaPJAvAURnmc1eBDZvyfrFIPpyjOgG
EP2GQw5M/wtj2wmiV/Rm7ALRSfsWHQXRcauvngLRUov2XwPRS0IvXwfRsYFZ
90F0+NKKByD6AXvfMxB9ptfnLYjOYHb4CKLvlbz/A6IjehVk64H082MciiC6
N//X2+VAmiVE5yOIXhW3lGEFkBbYtwpMbzz0UQBExy6TFATR24/u1wTRIvIs
WiA67QyPOYieHjbRBkTfSU5wBdFF+VVBIBoA54ajKg==
  "],
 CellLabel->"In[47]:=",ExpressionUUID->"502d581b-cf12-48d5-9693-19cc88bd081b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plotVectors", "[", 
    RowBox[{"v1_", ",", "v2_", ",", "range_"}], "]"}], ":=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "v1"}], "}"}], 
          "]"}], ",", "Thick", ",", "Red"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "v2"}], "}"}], 
          "]"}], ",", "Thick", ",", "Blue"}], "]"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "range"}], ",", "range"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "range"}], ",", "range"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "range"}], ",", "range"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plotVectors", "[", 
  RowBox[{"xc", ",", 
   RowBox[{"xcr", "[", 
    RowBox[{"xc", ",", "30"}], "]"}], ",", "4"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8255493397935953`*^9, 3.825549418709736*^9}, {
  3.825549480315505*^9, 3.825549633436602*^9}, {3.82555004060995*^9, 
  3.82555004522021*^9}, {3.825550082617629*^9, 3.8255501180294228`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"7c1d7092-1a14-44b4-a243-ddee5b03325f"],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[1, 0, 0], Thickness[Large], 
    Arrow3DBox[{{0, 0, 0}, {1, 3, 4}}]}, 
   {RGBColor[0, 0, 1], Thickness[Large], 
    Arrow3DBox[
     NCache[{{0, 0, 
       0}, {-2 + Rational[1, 2] 3^Rational[1, 2], 3, Rational[1, 2] + 
        2 3^Rational[1, 2]}}, {{0, 0, 
       0}, {-1.1339745962155614`, 3, 3.9641016151377544`}}]]}},
  Boxed->False,
  ImageSize->{388.29077074708107`, 415.6676586662197},
  ImageSizeRaw->Automatic,
  PlotRange->{{-4, 4}, {-4, 4}, {-4, 4}},
  ViewPoint->{0.2728046440601581, -1.9789151042670665`, 2.731203514255734},
  ViewVertical->{-0.4217866028801345, 0.16235219548652124`, 
   0.8920413814681145}]], "Output",
 CellChangeTimes->{3.82555008603966*^9, 3.825550119679202*^9, 
  3.825599133741148*^9, 3.82560032994602*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"52487d33-766d-453b-abb5-0a64f03c0317"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Create the 3x3 matrix that changes the components of the spherical tensor \
under the rotation\
\>", "Section",
 CellChangeTimes->{{3.825549233555708*^9, 
  3.825549253503599*^9}},ExpressionUUID->"f67ef5cf-ab3b-494c-b8b2-\
bed72bd5a07e"],

Cell[CellGroupData[{

Cell["Operations on a rank-2 tensor", "Subsection",
 CellChangeTimes->{{3.825461570887026*^9, 
  3.8254615758372803`*^9}},ExpressionUUID->"1f5ca1d6-de0b-4f81-99b8-\
aab49ea74b3f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{"A_", ",", "B_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ClebschGordan", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "m1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "m2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "\[Mu]"}], "}"}]}], "]"}], "*", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"2", "-", "m1"}], "]"}], "]"}], "*", 
         RowBox[{"B", "[", 
          RowBox[{"[", 
           RowBox[{"2", "-", "m2"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"m2", ",", "1", ",", 
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"m1", ",", "1", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T2", "[", 
    RowBox[{"A_", ",", "B_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"A", ",", "B", ",", "\[Mu]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"T", "[", 
         RowBox[{"A", ",", "B", ",", "\[Mu]"}], "]"}], "]"}]}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.82546157942871*^9, 3.825461585219157*^9}, {
  3.825461624818181*^9, 3.825461628837122*^9}, {3.825461851498149*^9, 
  3.825462070602565*^9}, {3.825462121959271*^9, 3.8254621823841543`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"3aca94a1-f9ec-4d22-88d7-bbfb18af2b30"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"T2", "[", 
      RowBox[{"VR", ",", "WR", ",", "\[Mu]"}], "]"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", ",", 
     RowBox[{"-", "2"}], ",", "2", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.825461981168583*^9, 3.825461990479726*^9}, {
  3.825462186514814*^9, 3.82546230392878*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"ab60219b-7077-4bb5-84dc-335adb26ad6c"],

Cell[BoxData[
 TemplateBox[{
  "ClebschGordan","phy",
   "\"\\!\\(\\*RowBox[{\\\"ThreeJSymbol\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\
\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\
\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \\\"2\\\"}], \
\\\"}\\\"}]}], \\\"]\\\"}]\\) is not physical.\"",2,56,21,
   32370913452626072074,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.825461990977849*^9, 3.82546200367476*^9}, 
   3.8254621112095423`*^9, {3.825462189736086*^9, 3.825462205185276*^9}, {
   3.825462285995941*^9, 3.825462304573372*^9}, 3.825463461548644*^9, 
   3.825463832287057*^9, 3.825465251337118*^9, 3.82554915681166*^9, 
   3.8255491972894163`*^9, 3.82554929568377*^9, {3.825549981845694*^9, 
   3.825549991954885*^9}, 3.825550073953043*^9, 3.825599133791933*^9, 
   3.825600329993083*^9},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"11d95987-de0f-442d-a0e8-3d84ef8345b0"],

Cell[BoxData[
 TemplateBox[{
  "ClebschGordan","phy",
   "\"\\!\\(\\*RowBox[{\\\"ThreeJSymbol\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\
\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\
\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \\\"2\\\"}], \
\\\"}\\\"}]}], \\\"]\\\"}]\\) is not physical.\"",2,56,22,
   32370913452626072074,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.825461990977849*^9, 3.82546200367476*^9}, 
   3.8254621112095423`*^9, {3.825462189736086*^9, 3.825462205185276*^9}, {
   3.825462285995941*^9, 3.825462304573372*^9}, 3.825463461548644*^9, 
   3.825463832287057*^9, 3.825465251337118*^9, 3.82554915681166*^9, 
   3.8255491972894163`*^9, 3.82554929568377*^9, {3.825549981845694*^9, 
   3.825549991954885*^9}, 3.825550073953043*^9, 3.825599133791933*^9, 
   3.8256003299983053`*^9},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"e8a67076-099f-470e-a928-83dfd9236768"],

Cell[BoxData[
 TemplateBox[{
  "ClebschGordan","phy",
   "\"\\!\\(\\*RowBox[{\\\"ThreeJSymbol\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\
\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \
\\\",\\\", \\\"2\\\"}], \\\"}\\\"}]}], \\\"]\\\"}]\\) is not physical.\"",2,
   56,23,32370913452626072074,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.825461990977849*^9, 3.82546200367476*^9}, 
   3.8254621112095423`*^9, {3.825462189736086*^9, 3.825462205185276*^9}, {
   3.825462285995941*^9, 3.825462304573372*^9}, 3.825463461548644*^9, 
   3.825463832287057*^9, 3.825465251337118*^9, 3.82554915681166*^9, 
   3.8255491972894163`*^9, 3.82554929568377*^9, {3.825549981845694*^9, 
   3.825549991954885*^9}, 3.825550073953043*^9, 3.825599133791933*^9, 
   3.825600330002431*^9},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"67c3d9a6-8916-45fe-8cab-9a1dc31509dc"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"ClebschGordan\\\", \
\\\"::\\\", \\\"phy\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,56,24,32370913452626072074,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.825461990977849*^9, 3.82546200367476*^9}, 
   3.8254621112095423`*^9, {3.825462189736086*^9, 3.825462205185276*^9}, {
   3.825462285995941*^9, 3.825462304573372*^9}, 3.825463461548644*^9, 
   3.825463832287057*^9, 3.825465251337118*^9, 3.82554915681166*^9, 
   3.8255491972894163`*^9, 3.82554929568377*^9, {3.825549981845694*^9, 
   3.825549991954885*^9}, 3.825550073953043*^9, 3.825599133791933*^9, 
   3.825600330006562*^9},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"1cc798e8-1df0-431d-a2fd-35a04f27b18f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Vz", " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}], "+", 
    RowBox[{"Vx", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Wz", " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}], "+", 
    RowBox[{"Wx", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}]}], 
   ")"}]}]], "Print",
 CellChangeTimes->{{3.8254622860167837`*^9, 3.8254623046125317`*^9}, 
   3.8254634616004257`*^9, 3.8254638323060427`*^9, 3.825465251358295*^9, 
   3.825549156831983*^9, 3.825549197308012*^9, 3.825549295738126*^9, {
   3.825549981867024*^9, 3.8255499920518017`*^9}, 3.825550074024824*^9, 
   3.8255991338756523`*^9, 3.825600330010335*^9},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"596a91b6-5b90-4ceb-9292-f88a76a4d204"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Vz", " ", "Wy"}], "+", 
      RowBox[{"Vy", " ", "Wz"}]}], ")"}], " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Vy", " ", "Wx"}], "+", 
      RowBox[{"Vx", " ", "Wy"}]}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}]}], 
  SqrtBox["2"]]], "Print",
 CellChangeTimes->{{3.8254622860167837`*^9, 3.8254623046125317`*^9}, 
   3.8254634616004257`*^9, 3.8254638323060427`*^9, 3.825465251358295*^9, 
   3.825549156831983*^9, 3.825549197308012*^9, 3.825549295738126*^9, {
   3.825549981867024*^9, 3.8255499920518017`*^9}, 3.825550074024824*^9, 
   3.8255991338756523`*^9, 3.82560033001127*^9},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"394361ed-3573-480a-81af-c772d6e325bb"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", "Vy", " ", "Wy"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Vz", " ", "Wx"}], "+", 
      RowBox[{"Vx", " ", "Wz"}]}], ")"}], " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"\[Pi]", " ", "\[Alpha]"}], "90"], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Vx", " ", "Wx"}], "-", 
      RowBox[{"Vz", " ", "Wz"}]}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"\[Pi]", " ", "\[Alpha]"}], "90"], "]"}]}]}], 
  SqrtBox["6"]]], "Print",
 CellChangeTimes->{{3.8254622860167837`*^9, 3.8254623046125317`*^9}, 
   3.8254634616004257`*^9, 3.8254638323060427`*^9, 3.825465251358295*^9, 
   3.825549156831983*^9, 3.825549197308012*^9, 3.825549295738126*^9, {
   3.825549981867024*^9, 3.8255499920518017`*^9}, 3.825550074024824*^9, 
   3.8255991338756523`*^9, 3.8256003300363083`*^9},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"a8f2e288-887f-4fba-9105-b2a96e9b4b14"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Vy", " ", "Wx"}], "+", 
      RowBox[{"Vx", " ", "Wy"}]}], ")"}], " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Vz", " ", "Wy"}], "+", 
      RowBox[{"Vy", " ", "Wz"}]}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}]}], 
  SqrtBox["2"]]], "Print",
 CellChangeTimes->{{3.8254622860167837`*^9, 3.8254623046125317`*^9}, 
   3.8254634616004257`*^9, 3.8254638323060427`*^9, 3.825465251358295*^9, 
   3.825549156831983*^9, 3.825549197308012*^9, 3.825549295738126*^9, {
   3.825549981867024*^9, 3.8255499920518017`*^9}, 3.825550074024824*^9, 
   3.8255991338756523`*^9, 3.825600330037384*^9},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"02d82780-2813-4ee1-8a1c-d5967bda253b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Vx", " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}], "-", 
    RowBox[{"Vz", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Wx", " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}], "-", 
    RowBox[{"Wz", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"\[Pi]", " ", "\[Alpha]"}], "180"], "]"}]}]}], 
   ")"}]}]], "Print",
 CellChangeTimes->{{3.8254622860167837`*^9, 3.8254623046125317`*^9}, 
   3.8254634616004257`*^9, 3.8254638323060427`*^9, 3.825465251358295*^9, 
   3.825549156831983*^9, 3.825549197308012*^9, 3.825549295738126*^9, {
   3.825549981867024*^9, 3.8255499920518017`*^9}, 3.825550074024824*^9, 
   3.8255991338756523`*^9, 3.8256003300440083`*^9},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"50f7969e-8472-4f2f-8aac-b8f0547a11fb"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate the rotated Cartesian vectors", "Section",
 CellChangeTimes->{{3.825600086460772*^9, 3.825600095753449*^9}, 
   3.825600154719203*^9},ExpressionUUID->"469a5b6f-e325-4617-a954-\
c9837319194d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VAC", "=", 
   RowBox[{"{", 
    RowBox[{"AX", ",", "AY", ",", "AZ"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VBC", "=", 
   RowBox[{"{", 
    RowBox[{"BX", ",", "BY", ",", "BZ"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RVAC", "=", 
   RowBox[{"rotateZ", "[", 
    RowBox[{"VAC", ",", "\[Alpha]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RVBC", "=", 
   RowBox[{"rotateZ", "[", 
    RowBox[{"VBC", ",", "\[Alpha]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8256000976679*^9, 3.825600150203229*^9}, {
  3.82560099194375*^9, 3.825600992109858*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"5e47b7b8-200d-47f2-9c70-e025972845b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate the rotated spherical vectors", "Section",
 CellChangeTimes->{{3.8256001562424*^9, 
  3.825600164881917*^9}},ExpressionUUID->"3a81e2c4-9039-4b9a-84bb-\
4bd6fdca428c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VAS", "=", 
   RowBox[{"Vsph", "[", "VAC", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VASR", "=", 
   RowBox[{"Vsph", "[", "RVAC", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VBS", "=", 
   RowBox[{"Vsph", "[", "VBC", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VBSR", "=", 
   RowBox[{"Vsph", "[", "RVBC", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8256001680259666`*^9, 3.8256001980611153`*^9}, {
  3.825600255040386*^9, 3.8256003319359627`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"02fe3f2d-241e-41a1-a22a-c4e6884070e0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"T2", "[", 
  RowBox[{"VAS", ",", "VBS", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.825600719855981*^9, 3.825600737198079*^9}, {
   3.825600816005975*^9, 3.825600816329505*^9}, {3.825600852467286*^9, 
   3.825600882266384*^9}, 3.825600935000001*^9, {3.8256010010695667`*^9, 
   3.8256010013457127`*^9}, {3.825601054843156*^9, 3.825601065358953*^9}, {
   3.825601229552446*^9, 3.82560122984042*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"dd096ccf-ab24-43d9-868b-03a508d93c7b"],

Cell[BoxData[
 TemplateBox[{
  "ClebschGordan","phy",
   "\"\\!\\(\\*RowBox[{\\\"ThreeJSymbol\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\
\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\
\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) is not physical.\"",2,99,78,
   32370913452626072074,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.825600732732278*^9, 3.82560073761255*^9}, 
   3.8256008165406103`*^9, {3.825600858457651*^9, 3.8256008824839983`*^9}, 
   3.8256009351896973`*^9, {3.825600996691347*^9, 3.825601001571664*^9}, {
   3.825601055204276*^9, 3.8256010655375013`*^9}, 3.825601231581164*^9},
 CellLabel->
  "During evaluation of \
In[99]:=",ExpressionUUID->"cf4d45bd-aa51-4d8f-b89f-4116b731ab89"],

Cell[BoxData[
 TemplateBox[{
  "ClebschGordan","phy",
   "\"\\!\\(\\*RowBox[{\\\"ThreeJSymbol\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\
\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \
\\\",\\\", RowBox[{\\\"-\\\", \\\"1\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) is \
not physical.\"",2,99,79,32370913452626072074,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.825600732732278*^9, 3.82560073761255*^9}, 
   3.8256008165406103`*^9, {3.825600858457651*^9, 3.8256008824839983`*^9}, 
   3.8256009351896973`*^9, {3.825600996691347*^9, 3.825601001571664*^9}, {
   3.825601055204276*^9, 3.8256010655375013`*^9}, 3.825601231586776*^9},
 CellLabel->
  "During evaluation of \
In[99]:=",ExpressionUUID->"9a3e5172-59a6-4208-90bf-bc936e177b56"],

Cell[BoxData[
 TemplateBox[{
  "ClebschGordan","phy",
   "\"\\!\\(\\*RowBox[{\\\"ThreeJSymbol\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\
\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\
\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) is not physical.\"",2,99,80,
   32370913452626072074,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.825600732732278*^9, 3.82560073761255*^9}, 
   3.8256008165406103`*^9, {3.825600858457651*^9, 3.8256008824839983`*^9}, 
   3.8256009351896973`*^9, {3.825600996691347*^9, 3.825601001571664*^9}, {
   3.825601055204276*^9, 3.8256010655375013`*^9}, 3.825601231591421*^9},
 CellLabel->
  "During evaluation of \
In[99]:=",ExpressionUUID->"1a7b0bad-f245-4ef9-b653-3599f66a192b"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"ClebschGordan\\\", \
\\\"::\\\", \\\"phy\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,99,81,32370913452626072074,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.825600732732278*^9, 3.82560073761255*^9}, 
   3.8256008165406103`*^9, {3.825600858457651*^9, 3.8256008824839983`*^9}, 
   3.8256009351896973`*^9, {3.825600996691347*^9, 3.825601001571664*^9}, {
   3.825601055204276*^9, 3.8256010655375013`*^9}, 3.825601231595909*^9},
 CellLabel->
  "During evaluation of \
In[99]:=",ExpressionUUID->"1c4bd0bc-a5c2-452c-9c44-6d0cf2cf0528"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", "AZ", " ", 
   RowBox[{"(", 
    RowBox[{"BX", "+", 
     RowBox[{"\[ImaginaryI]", " ", "BY"}]}], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"AX", "+", 
     RowBox[{"\[ImaginaryI]", " ", "AY"}]}], ")"}], " ", "BZ"}]}]], "Output",
 CellChangeTimes->{{3.825600732753693*^9, 3.8256007376322813`*^9}, 
   3.825600816586128*^9, {3.82560085847703*^9, 3.825600882528284*^9}, 
   3.8256009352295628`*^9, {3.825600996712071*^9, 3.825601001623909*^9}, {
   3.8256010552240467`*^9, 3.825601065558165*^9}, 3.825601231628716*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"7a98081d-5033-4543-b1c5-558b69ccb5f6"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{975, 1100},
WindowMargins->{{Automatic, 227}, {101, Automatic}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 276, 8, 117, "Chapter",ExpressionUUID->"78757379-f552-46b5-922a-72222e37f454"],
Cell[701, 25, 238, 4, 30, "Input",ExpressionUUID->"9cc7d27f-a8e6-46ff-be2c-67f9e931257b"],
Cell[942, 31, 460, 12, 52, "Input",ExpressionUUID->"deacf788-95f1-4730-8182-d08a60084873"],
Cell[1405, 45, 2788, 72, 157, "Input",ExpressionUUID->"e715a690-11af-41ff-a01b-ef26718ec5f6"],
Cell[4196, 119, 609, 13, 52, "Input",ExpressionUUID->"d45496ee-05a9-44ec-b96f-0665f61eefd1"],
Cell[CellGroupData[{
Cell[4830, 136, 232, 4, 30, "Input",ExpressionUUID->"30bbeb34-00c0-4cb4-87a4-6c647b64312f"],
Cell[5065, 142, 4938, 137, 135, "Print",ExpressionUUID->"01a2b91a-7dad-4434-ad3b-8ff7c8ebba61"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10040, 284, 229, 4, 30, "Input",ExpressionUUID->"ac5aae97-0615-447f-88a9-36096bf8113e"],
Cell[10272, 290, 4878, 137, 135, "Print",ExpressionUUID->"f5621a31-3d05-4131-94f1-3880bab339d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15187, 432, 193, 3, 54, "Subsection",ExpressionUUID->"f3374489-ddbe-491b-b639-ca0eef93ed73"],
Cell[15383, 437, 1388, 44, 136, "Input",ExpressionUUID->"55fc9785-e1ab-4530-93b5-07bec836c8d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16808, 486, 488, 13, 81, "Subsection",ExpressionUUID->"94230187-b365-4e93-b3ed-6a151575ee51"],
Cell[17299, 501, 2369, 69, 157, "Input",ExpressionUUID->"502d581b-cf12-48d5-9693-19cc88bd081b"],
Cell[CellGroupData[{
Cell[19693, 574, 1701, 46, 94, "Input",ExpressionUUID->"7c1d7092-1a14-44b4-a243-ddee5b03325f"],
Cell[21397, 622, 868, 19, 433, "Output",ExpressionUUID->"52487d33-766d-453b-abb5-0a64f03c0317"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22314, 647, 247, 6, 105, "Section",ExpressionUUID->"f67ef5cf-ab3b-494c-b8b2-bed72bd5a07e"],
Cell[CellGroupData[{
Cell[22586, 657, 179, 3, 54, "Subsection",ExpressionUUID->"1f5ca1d6-de0b-4f81-99b8-aab49ea74b3f"],
Cell[22768, 662, 1888, 53, 94, "Input",ExpressionUUID->"3aca94a1-f9ec-4d22-88d7-bbfb18af2b30"],
Cell[CellGroupData[{
Cell[24681, 719, 514, 12, 30, "Input",ExpressionUUID->"ab60219b-7077-4bb5-84dc-335adb26ad6c"],
Cell[25198, 733, 1047, 19, 24, "Message",ExpressionUUID->"11d95987-de0f-442d-a0e8-3d84ef8345b0"],
Cell[26248, 754, 1049, 19, 24, "Message",ExpressionUUID->"e8a67076-099f-470e-a928-83dfd9236768"],
Cell[27300, 775, 1068, 19, 24, "Message",ExpressionUUID->"67c3d9a6-8916-45fe-8cab-9a1dc31509dc"],
Cell[28371, 796, 857, 16, 24, "Message",ExpressionUUID->"1cc798e8-1df0-431d-a2fd-35a04f27b18f"],
Cell[CellGroupData[{
Cell[29253, 816, 1090, 30, 38, "Print",ExpressionUUID->"596a91b6-5b90-4ceb-9292-f88a76a4d204"],
Cell[30346, 848, 982, 27, 53, "Print",ExpressionUUID->"394361ed-3573-480a-81af-c772d6e325bb"],
Cell[31331, 877, 1029, 28, 53, "Print",ExpressionUUID->"a8f2e288-887f-4fba-9105-b2a96e9b4b14"],
Cell[32363, 907, 983, 27, 53, "Print",ExpressionUUID->"02d82780-2813-4ee1-8a1c-d5967bda253b"],
Cell[33349, 936, 1092, 30, 38, "Print",ExpressionUUID->"50f7969e-8472-4f2f-8aac-b8f0547a11fb"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34514, 974, 206, 3, 67, "Section",ExpressionUUID->"469a5b6f-e325-4617-a954-c9837319194d"],
Cell[34723, 979, 742, 21, 94, "Input",ExpressionUUID->"5e47b7b8-200d-47f2-9c70-e025972845b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35502, 1005, 181, 3, 67, "Section",ExpressionUUID->"3a81e2c4-9039-4b9a-84bb-4bd6fdca428c"],
Cell[35686, 1010, 621, 15, 94, "Input",ExpressionUUID->"02fe3f2d-241e-41a1-a22a-c4e6884070e0"],
Cell[CellGroupData[{
Cell[36332, 1029, 508, 8, 30, "Input",ExpressionUUID->"dd096ccf-ab24-43d9-868b-03a508d93c7b"],
Cell[36843, 1039, 908, 16, 24, "Message",ExpressionUUID->"cf4d45bd-aa51-4d8f-b89f-4116b731ab89"],
Cell[37754, 1057, 927, 16, 24, "Message",ExpressionUUID->"9a3e5172-59a6-4208-90bf-bc936e177b56"],
Cell[38684, 1075, 908, 16, 24, "Message",ExpressionUUID->"1a7b0bad-f245-4ef9-b653-3599f66a192b"],
Cell[39595, 1093, 697, 13, 24, "Message",ExpressionUUID->"1c4bd0bc-a5c2-452c-9c44-6d0cf2cf0528"],
Cell[40295, 1108, 726, 17, 50, "Output",ExpressionUUID->"7a98081d-5033-4543-b1c5-558b69ccb5f6"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

